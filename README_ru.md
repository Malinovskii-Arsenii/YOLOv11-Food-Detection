
# Обнаружение блюд с помощью YOLOv11

## Обзор задачи

Этот проект является частью тестового задания на позицию Python Developer (Computer Vision, ML). Цель — разработка модели распознавания блюд на основе видео с использованием YOLOv11, включая весь путь: от подготовки данных до оценки результатов.

---

## Структура проекта

```
.
├── results/                     # CSV-файлы и графики с результатами обучения
├── runs/                        # Модели YOLO с весами и метриками
├── READMEru.md                  # Этот файл
├── extract_frames.ipynb         # Извлечение кадров из видео и код для обучения YOLOv11
└── requirements.txt             # Python-зависимости
```

---

## 1. Подготовка данных

### 1.1 Извлечение кадров из видео

- Видео в формате .MOV были обработаны.
- Извлечено 638 кадров с частотой ~1 FPS с помощью cv2.VideoCapture.

### 1.2 Разметка

- Разметка выполнена вручную через Roboflow Annotate.
- Классы: tea, shashlik, greek_salad, lamb, borscht, caesar_salad, cheese_soup

### 1.3 Аугментация

- Выполнена в Roboflow:
  - Отражение: по горизонтали, по вертикали
  - Поворот: от -15° до +15°
  - Насыщенность: от -25% до +25%
  - Яркость: от -20% до +20%
  - Шум: до 1.05% пикселей

### 1.4 Разделение датасета

- Разделение выполнено следующим образом:
  - train: 88%
  - val: 8%
  - test: 4%

---

## 2. Обучение модели

### 2.1 Первый эксперимент

```python
model.train(
    data='dataset/data.yaml',
    epochs=50,
    imgsz=640,
    batch=16,
    project='runs',
    name='yolov11-dish',
    save_period=10
)
```

**Результаты:**

- Precision: 0.9910  
- Recall: 0.9821  
- mAP@0.5: 0.9902  
- mAP@0.5:0.95: 0.8858  
- Val box loss: 0.4415

### 2.2 Второй эксперимент

```python
model.train(
    epochs=30,
    imgsz=640,
    batch=16,
    lr0=0.002,
    optimizer='SGD',
    project='runs',
    name='yolov11-dish_v2',
    save_period=5
)
```

**Результаты:**

- Precision: 0.9941  
- Recall: 0.9949  
- mAP@0.5: 0.9940  
- mAP@0.5:0.95: 0.9296  
- Val box loss: 0.3329

---

## 3. Метрики и визуализация

Все метрики обучения (loss, mAP, precision, recall) были сохранены и визуализированы:

- results/results_v1.csv
- results/results_v2.csv

Визуальное сравнение показывает стабильное улучшение всех метрик после настройки гиперпараметров.

---

## 4. Выводы и сложности

- Разметка оказалась самой трудоёмкой частью.
- Roboflow значительно ускорил процесс аннотации и аугментации.
- Тюнинг гиперпараметров существенно улучшил качество модели.

---

## Время выполнения

- Всего: ~20–22 часа
  - Подготовка данных: 6 часов
  - Обучение и тюнинг: 8 часов
  - Анализ и отчёт: 6–8 часов

---

## Опыт работы с YOLO

До этой задачи: использование YOLOv8 для дипломного проекта CV и для коммерческих проектов, полный цикл работы с YOLOv11, обучение, настройка, анализ.

---

## Как воспроизвести

1. Клонируйте репозиторий:

```bash
git clone https://github.com/Malinovskii-Arsenii/yolov11-food-detection
cd yolov11-food-detection
```

2. Установите зависимости:

```bash
pip install -r requirements.txt
```

3. Обучите модель:

```python
from ultralytics import YOLO
model = YOLO('yolov11n.pt')
model.train(data='dataset/data.yaml', epochs=50, imgsz=640)
```

4. Запустите инференс:

```python
results = model('path/to/image.jpg', save=True)
```
